# IOC 和 DI

## 什么是IOC

IOC，Inversion of Control，控制反转，指将对象的控制权转移给Spring框架，由 Spring 来负责控制对象的生命周期（比如创建、销毁）和对象间的依赖关系。

最直观的表达就是，以前创建对象的时机和主动权都是由自己把控的，如果在一个对象中使用另外的对象，就必须主动通过new指令去创建依赖对象，使用完后还需要销毁（比如Connection等），对象始终会和其他接口或类耦合起来。而 IOC 则是由专门的容器来帮忙创建对象，将所有的类都在 Spring 容器中登记，当需要某个对象时，不再需要自己主动去 new 了，只需告诉 Spring 容器，然后 Spring 就会在系统运行到适当的时机，把你想要的对象主动给你。也就是说，对于某个具体的对象而言，以前是由自己控制它所引用对象的生命周期，而在IOC中，所有的对象都被 Spring 控制，控制对象生命周期的不再是引用它的对象，而是Spring容器，由 Spring 容器帮我们创建、查找及注入依赖对象，而引用对象只是被动的接受依赖对象，所以这叫控制反转。

控制反转，并不是什么先进的技术，只是一种设计原则或设计模式。对于IoC来说，最重要的就是容器。容器管理着Bean的生命周期，控制着Bean的依赖注入。

## 什么是DI

DI，Dependency Injection，依赖注入，可以将 DI 看作是 IOC 的一种实现方式：即组件以一些预先定义好的方式（例如：setter 方法）接受来自于容器的资源注入。

 IoC 的一个重点就是在程序运行时，动态的向某个对象提供它所需要的其他对象，这一点是通过DI来实现的，即应用程序在运行时依赖 IoC 容器来动态注入对象所需要的外部依赖。而 Spring 的 DI 具体就是通过反射实现注入的，反射允许程序在运行的时候动态的生成对象、执行对象的方法、改变对象的属性。

## IoC的作用

-   管理对象的创建和依赖关系的维护。对象的创建并不是一件简单的事，在对象关系比较复杂时，如果依赖关系需要程序员来维护，那是相当麻烦的。
-   解耦，由容器去维护具体的对象
-   托管了类的产生过程，比如需要在类的产生过程中做一些处理，最直接的例子就是代理，如果有容器程序可以把这部分处理交给容器，应用程序则无需关心类是如何完成代理的。

## IoC和DI的区别

IoC是解决耦合问题的一种设计思想，DI是IoC的一种实现。

IoC主要的实现方式有两种：依赖查找（DL），依赖注入（DI）。

-   依赖查找（DL），Dependency Lookup，容器给组件提供回调接口，组件主动调用容器的API来查询依赖对象
-   依赖注入（DI），Dependency Injection，组件不做查询操作，组件只提供普通Java方法给容器使用，让容器解析依赖
